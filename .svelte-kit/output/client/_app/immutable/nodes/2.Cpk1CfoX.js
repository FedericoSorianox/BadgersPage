import{S as M,i as S,s as x,d,v as I,w as k,x as J,b as g,y,z as T,n as f,p as U,c as p,e as _,f as h,j as v,o as E,h as z,g as C,k as m,t as A,l as N,A as V,B,C as j,D,E as H}from"../chunks/A-LiUoMI.js";import"../chunks/IHki7fMi.js";import{g as L}from"../chunks/B3yLMbad.js";import{s as P}from"../chunks/DJAy97j8.js";const Z="https://patvitueymlukulirofq.supabase.co",F="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBhdHZpdHVleW1sdWt1bGlyb2ZxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE4MTEwNTIsImV4cCI6MjA2NzM4NzA1Mn0.GzjU5e1QDQyaSk-Ttm3bJr789U-Ri4zjX4miFJMoZ_U";function O(c){let e,r='<p>Acceso denegado...</p> <a href="/debug" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 mt-4">Debug</a>';return{c(){e=m("div"),e.innerHTML=r,this.h()},l(t){e=h(t,"DIV",{class:!0,"data-svelte-h":!0}),C(e)!=="svelte-34c8et"&&(e.innerHTML=r),this.h()},h(){_(e,"class","text-center p-16")},m(t,o){g(t,e,o)},p:f,i:f,o:f,d(t){t&&d(e)}}}function R(c){let e;const r=c[5].default,t=V(r,c,c[4],null);return{c(){t&&t.c()},l(o){t&&t.l(o)},m(o,a){t&&t.m(o,a),e=!0},p(o,a){t&&t.p&&(!e||a&16)&&B(t,r,o,o[4],e?D(r,o[4],a,null):j(o[4]),null)},i(o){e||(k(t,o),e=!0)},o(o){I(t,o),e=!1},d(o){t&&t.d(o)}}}function X(c){let e,r="<p>Verificando acceso...</p>";return{c(){e=m("div"),e.innerHTML=r,this.h()},l(t){e=h(t,"DIV",{class:!0,"data-svelte-h":!0}),C(e)!=="svelte-k8hadl"&&(e.innerHTML=r),this.h()},h(){_(e,"class","text-center p-16")},m(t,o){g(t,e,o)},p:f,i:f,o:f,d(t){t&&d(e)}}}function G(c){let e,r,t,o,a,n,u="Verificar Configuración";return{c(){e=m("div"),r=m("p"),t=A("Error: "),o=A(c[3]),a=N(),n=m("a"),n.textContent=u,this.h()},l(l){e=h(l,"DIV",{class:!0});var s=v(e);r=h(s,"P",{class:!0});var i=v(r);t=E(i,"Error: "),o=E(i,c[3]),i.forEach(d),a=z(s),n=h(s,"A",{href:!0,class:!0,"data-svelte-h":!0}),C(n)!=="svelte-f2nj7e"&&(n.textContent=u),s.forEach(d),this.h()},h(){_(r,"class","text-red-600 mb-4"),_(n,"href","/env-check"),_(n,"class","bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"),_(e,"class","text-center p-16")},m(l,s){g(l,e,s),p(e,r),p(r,t),p(r,o),p(e,a),p(e,n)},p(l,s){s&8&&U(o,l[3])},i:f,o:f,d(l){l&&d(e)}}}function Q(c){let e,r,t,o,a;const n=[G,X,R,O],u=[];function l(s,i){return i&5&&(e=null),s[3]?0:s[1]?1:(e==null&&(e=!!(s[2]&&s[0].session&&(s[0].role||"").trim().toLowerCase()==="admin")),e?2:3)}return r=l(c,-1),t=u[r]=n[r](c),{c(){t.c(),o=y()},l(s){t.l(s),o=y()},m(s,i){u[r].m(s,i),g(s,o,i),a=!0},p(s,[i]){let b=r;r=l(s,i),r===b?u[r].p(s,i):(H(),I(u[b],1,1,()=>{u[b]=null}),J(),t=u[r],t?t.p(s,i):(t=u[r]=n[r](s),t.c()),k(t,1),t.m(o.parentNode,o))},i(s){a||(k(t),a=!0)},o(s){I(t),a=!1},d(s){s&&d(o),u[r].d(s)}}}function Y(c,e,r){let{$$slots:t={},$$scope:o}=e,{data:a}=e,n=!0,u=!1,l=null;return T(async()=>{try{await new Promise(w=>setTimeout(w,100));const{data:{session:s},error:i}=await P.auth.getSession();if(i){r(3,l=`Error de sesión: ${i.message}`),r(1,n=!1);return}if(console.log("data en /admin layout:",a),console.log("session en /admin layout:",s),!s){L("/login");return}if((a.role||"").trim().toLowerCase()!=="admin"){r(3,l=`Acceso denegado. Rol detectado: "${a.role}"`),L("/");return}r(2,u=!0),r(1,n=!1)}catch(s){r(3,l=`Error inesperado: ${s instanceof Error?s.message:String(s)}`),r(1,n=!1)}}),c.$$set=s=>{"data"in s&&r(0,a=s.data),"$$scope"in s&&r(4,o=s.$$scope)},[a,n,u,l,o,t]}class ee extends M{constructor(e){super(),S(this,e,Y,Q,x,{data:0})}}export{ee as component};
